#!/bin/bash

MAX_B=16

#PREFERRED=11

sleep 3

CORR=$( xdotool getmouselocation 2>&1 | sed 's/:/ /g' | awk '/window/ {print $2-1020, $4-340}' )

while true ; do
	for i in $( seq $MAX_B ) ; do
		for j in $PREFERRED $( awk 'BEGIN {srand(); print int('$MAX_B'*rand())+1}' ) ; do
			case $j in
				(1)  XY="1020 340";;
				(2)  XY="1160 410";;
				
				(3)  XY="740  340";;
				(4)  XY="880  410";;
				(5)  XY="1020 480";;
				(6)  XY="1160 550";;
				
				(7)  XY="600  410";;
				(8)  XY="740  480";;
				(9)  XY="880  550";;
				(10) XY="1020 620";;
				
				(11) XY="460  480";;
				(12) XY="600  550";;
				(13) XY="740  620";;
				(14) XY="880  690";;
				
				(15) XY="460  620";;
				(16) XY="600  690";;
			esac
			XYC=$( echo $XY $CORR | awk '{print $1+$3, $2+$4}' )
			xdotool mousemove --sync $XYC click 1 # select building
			sleep 1.5
			xdotool click 1 # Upgrade
			sleep 3
			xdotool click 1 # speed up
			sleep .5
		done
		sleep .5
	done
	xdotool mousemove --sync 1276 335 click 1 # kill Kingdom Quest
	sleep 1
done

# same row, 1 right: +140 +70
# next row: +140
